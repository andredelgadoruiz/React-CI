name: CI/CD

on:
  push:
    branches:
      - main
  pull_request:
    branches: [main]
    types: [opened, synchronize]
  
jobs:
  
  # avoid_reduncy:
  #   runs-on: ubuntu-18.04
  #   steps:
  #     - name: Cancel previous redundand builds
  #       uses: styfle/cancel-workflow-action@0.9.1
  #       with:
  #         access_token: ${{ github.token }}

  # lint:
  #   runs-on: ubuntu-18.04
  #   steps:
  #     - uses: actions/checkout@v3
  #       with:
  #         fetch-depth: 0
  #     - uses: actions/setup-node@v3
  #       with:
  #         node-version: 14
  #     - name: Install dependencies
  #       run: npm ci
  #     - name: Lint
  #       run: npm run eslint


  # build:
  #   runs-on: ubuntu-18.04
  #   steps:
  #     - uses: actions/checkout@v3
  #       with:
  #         fetch-depth: 0
  #     - uses: actions/setup-node@v3
  #       with:
  #         node-version: 14
  #     - name: Install dependencies
  #       run: npm ci
  #     - name: Build
  #       run: npm run build
  #     - uses: actions/upload-artifact@v2
  #       with:
  #         name: dist
  #         path: dist



  newrelic:
    runs-on: ubuntu-latest
    steps:
    - run: |
       curl -X POST 'https://insights-collector.newrelic.com/v1/accounts/1754826/events' \
            -H 'X-Insert-Key:86eef6eb515d668f7d5737da0154f9e74e53531d' -i \
            -H 'Content-Type: application/json' \
            -d \
       '{
          "eventType": "BelDeployment",
          "appId": "1634709621",
          "appName": "Velocity Devops",
          "revision": "${{ github.ref }}",
          "environment": "${{ github.ref_type	}}",
          "type": "${{ github.event_name}}",
          "jobName": "${{ github.job }}",
          "branchName": "${{ github.ref_name }}",
          "commit": "${{ github.sha }}",
          "user": "${{ github.actor }}",
          "buildStatus": "SUCCESS",
        }'




